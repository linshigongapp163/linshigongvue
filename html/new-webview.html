<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>detail</title>
		<script src="../js/mui.min.js"></script>
		<script src="../js/vue.js"></script>
		<script src="../js/common.js"></script>
		

		<link href="../css/mui.min.css" rel="stylesheet" />
		<style type="text/css">
			ul {
				background-color: white;
				margin: 15px 0;
				padding: 0 15px;
			}
			
			li {
				list-style-type: none;
				border-bottom: 1px solid #efeff4;
				background-color: white;
				height: 50px;
				line-height: 50px;
			}
			label {
				margin: auto 10px;
			}
			
			.mui-table-view {
    /*position: relative;
    margin-top: 0;
    margin-bottom: 0;
    padding-left: 0;
    list-style: none;*/
    background-color: #f7f7f7;
   }	
   			[v-cloak]{
				display: none;
			}		
		</style>

	</head>

	<body>
		<div id="app" v-cloak style="margin-bottom: 30px;">
			
		<!--<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">新窗口</h1>
		</header>-->
		<div class="mui-content">
			<p style="margin-top:20px;margin-left: 20px;text-align:center;font-size:20px;color:#FF0000">帐&nbsp户&nbsp余&nbsp额</p>
		</div>
		<div class="mui-content">
			<p style="margin-top:20px;margin-left: 20px;color:white;font-size: 24px;text-align: center;">11000 <span style="color: #888888">元</span></p>
		</div>		
		
			<ul class="mui-table-view mui-table-view-striped mui-table-view-condensed" style="padding: 30px 0;color: #;">

				<li id="user_avatar" style="height: 80px;line-height: 80px;">
					<label style="line-height: 50px;">最近报名 </label> <span style="" v-bind:style="styleenlist(listdata.enlist)">{{listdata.enlist}}</span>
				</li>
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>补贴</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.subsidy}}</span>
				</li>	

				<li id='user_phone' style="height:100px;background-color: #F7F7F7;">
					<label>补贴标准及计算，以实际报到入职时间为准，请及时到岗。</label>
				</li>					
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>入职时间</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.year}}年{{listdata.month}}月{{listdata.day}}日{{listdata.hour}}时{{listdata.minute}}分</span>
				</li>
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>入职项目</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.title}}</span>
				</li>
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>入职岗位</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.job}}</span>
				</li>
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>实际补贴标准</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.content}}</span>
				</li>
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>本次金额</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.thmoney}}</span>
				</li>				
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>已付金额</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.paid}}</span>
				</li>				
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>剩余金额</label><span v-bind:style="stylesubsidy(listdata.subsidy)">{{listdata.unpaid}}</span>
				</li>				
				
				
				
				<li id='user_t_name' style="margin-top: 20px;">
					<label>最近推荐</label><label style="font-size:14px;color: #CCCCCC;font-family: '仿宋';">还没有记录</label>
					
					<label style="float: right;margin-right: 10px;font-size: 14px;color: #BBBBBB;">

					</label>
				</li>				
				<li id='user_t_name'>
					<label>推荐名单</label><label style="font-size:14px;color: #CCCCCC;font-family: '仿宋';">还没有记录</label>
					
					<label style="float: right;margin-right: 10px;font-size: 14px;color: #BBBBBB;">

					</label>
				</li>
				<li id='user_phone' style="background-color: #F7F7F7;">
					<label>推荐奖金</label><label style="font-size:14px;float: right;margin-right: 10px;font-size: 14px;color: white;">10000元</label>
				</li>				

			</ul>		
		</div>
		
		<script src="../js/util.js"></script>

		<script>
			(function() {

				mui.init();
				//			var view = plus.nativeObj.View.getViewById('icon');
				//			view.show();
				mui.plusReady(function() {

					var vm = new Vue({
						el:'#app',
						data:{
							listdata:{
								enlist:'还没有记录',
								subsidy:'1000元',
								recommend:'还没有记录',
								title:'暂未入职',
								job:'',
								year:'',
								month:'',
								day:'',
								hour:'',
								minute:'',
								content:'',
								thmoney:'',
								paid:'',
								unpaid:''
								
							}
						},
						methods:{
							styleenlist:function(s){
								if(s=='还没有记录'){
								    return  "font-size:14px;color: #CCCCCC;font-family: '仿宋';"
								}else{
									return  "font-size:14px;color: #888888;font-family: '仿宋';"
								}
							},
							stylesubsidy:function(s){
								if(s=='1000元'){
								    return  "font-size:14px;color: #CCCCCC;font-family: '仿宋';"
								}else{
									return  "line-height:150%；overflow:hidden;white-space:nwrap;text-overflow:ellipsis;font-size:14px;color: #888888;font-family: '仿宋';"
								}
							}
						}
					});
					
//					var enlist = localStorage.getItem('enlist');
//					if(enlist){
//						vm.listdata.enlist = enlist;
//						vm.listdata.subsidy = localStorage.getItem('subsidy');							
//					}else{
	console.log('api_token=='+localStorage.getItem('api_token'))
						mui.ajax(APP_DOMAIN + 'api/enlist', {
							data: {
								api_token: localStorage.getItem('api_token'),
								user_id: localStorage.getItem('userId'),
							},
							dataType: 'json',
							type: 'get',
							timeout: 10000,
							headers: {
//								'Content-Type': 'application/json'
							},
							success: function(data) {
								console.log('enlist---data---' + JSON.stringify(data));
//								mui.toast('报名已提交'	
								vm.listdata.enlist = data.title;
								vm.listdata.subsidy = data.subsidy;
								recommend:'还没有记录'

							},
							error: function(xhr, type, errorThrown) {
								console.log(xhr.response);
								console.log(type);
							}
					});
						
						
						
//					};
					
						mui.ajax(APP_DOMAIN + 'api/cashbox', {
							data: {
								api_token: localStorage.getItem('api_token'),
								userid: localStorage.getItem('userId'),
							},
							dataType: 'json',
							type: 'get',
							timeout: 10000,
							headers: {
								'Content-Type': 'application/json'
							},
							success: function(data) {
								console.log('cashbox---data---' + JSON.stringify(data));
//								mui.toast('报名已提交')
//								localStorage.setItem('enlist', vm.detaildata.title);
//								localStorage.setItem('subsidy', vm.detaildata.subsidy);
//								var newwebview = plus.webview.getElementById('new-webview.html');
//								mui.fire(newwebview, 'enlist', {
//									detaildata: {
//										enlist: vm.detaildata.title,
//										subsidy: vm.detaildata.subsidy
//									}
//								})

							},
							error: function(xhr, type, errorThrown) {
								console.log(xhr.response);
								console.log(type);
							}
						})					
					
				
					document.addEventListener('enlist',function(e){
						console.log('-----------=====++++');
						var detaildata = e.detail.detaildata;
						console.log('detail-data=='.JSON.stringify(detaildata));
						vm.listdata.enlist = detaildata.enlist;
						vm.listdata.subsidy = detaildata.subsidy;
					});

					var self = plus.webview.currentWebview(),
						leftPos = Math.ceil((window.innerWidth - 80) / 2); // 设置凸起大图标为水平居中

					/**	
					 *  绘制原生导航条，
					 */
					var h = plus.webview.getLaunchWebview(),
						nviewObj = h.getStyle().subNViews;
					var tabBar2 = util.drawNative('tabBar2', nviewObj[0].styles, nviewObj[0].tags);
					// append 到父webview中
					self.append(tabBar2);

					/**	
					 * drawNativeIcon 绘制带边框的半圆，
					 * 实现原理：
					 *   id为bg的tag 创建带边框的圆
					 *   id为bg2的tag 创建白色矩形遮住圆下半部分，只显示凸起带边框部分
					 * 	 id为iconBg的红色背景图
					 *   id为icon的字体图标
					 *   注意创建先后顺序，创建越晚的层级越高
					 */
					var drawNativeIcon = util.drawNative('icon2', {
						bottom: '1px',
						left: leftPos + 'px',
						width: '80px',
						height: '70px'
					}, [{
						tag: 'img',
						id: 'img',
						src: '_www/myimg/money_helper_open.png',
						position: {
							top: '5px',
							left: '5px',
							width: '70px',
							height: '60px'
						}
					}]);
					// append 到父webview中
					self.append(drawNativeIcon);

					// 创建子webview窗口 并初始化
					var aniShow = {};
					var nview = plus.nativeObj.View.getViewById('tabBar2'),
						activePage = plus.webview.currentWebview(),
						targetPage,
						subpages = util.options.subpages,
						pageW = window.innerWidth,
						currIndex = 0;
					/**
					 * 根据判断view控件点击位置判断切换的tab
					 */
					tabBar2.addEventListener('click', function(e) {
						var clientX = e.clientX;
						console.log('clientX==='+clientX);
						console.log('clientX==='+parseInt(pageW * 0.45));
						
console.log('0,75==='+clientX <= parseInt(pageW * 0.75))
						if(clientX > 0 & clientX <= parseInt(pageW * 0.45)) {
							currIndex = 0;
							console.log('currIndex====0')
							//触发首页对应选项卡;							
						} 
//						else if(clientX > parseInt(pageW * 0.45)  && clientX <= parseInt(pageW * 0.75))
						else if(clientX > parseInt(pageW * 0.45))
						{
							currIndex = 1;
							console.log('currIndex==='+currIndex);
						};
						mui.fire(h, 'getnewclick', { newCurrIndex: currIndex});
						var ws = plus.webview.currentWebview();
						plus.webview.close(ws);
//						plus.webview.getDisplayWebview().close;
					});
				});
			})();
		</script>
	</body>

</html>